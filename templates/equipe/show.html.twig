{% extends 'base.html.twig' %}
{% block title %}Equipe {{ equipe.nom }}{% endblock %}

{% block body %}

<style>

/* ===== PAGE ===== */
.page-wrapper{
    max-width:1100px;
    margin:60px auto;
    padding:0 20px;
    color:#e5e7eb;
}

/* ===== TEAM HERO ===== */
.team-hero{
    background:
        radial-gradient(circle at center,#1f2937,#020617 70%);
    border-radius:22px;
    padding:40px 35px;
    box-shadow:0 25px 70px rgba(0,0,0,.7);
    position:relative;
    overflow:hidden;
}

/* glow effect */
.team-hero::before{
    content:'';
    position:absolute;
    inset:0;
    background:linear-gradient(120deg,transparent,rgba(139,92,246,.25),transparent);
    opacity:.35;
    pointer-events:none;
}

/* HEADER */
.team-header{
    display:flex;
    align-items:center;
    gap:25px;
    margin-bottom:30px;
}

/* LOGO */
.team-logo{
    width:110px;
    height:110px;
    border-radius:50%;
    background:#020617;
    border:2px solid #8b5cf6;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:32px;
    font-weight:900;
}

.team-logo img{
    width:100%;
    height:100%;
    object-fit:cover;
    border-radius:50%;
}

/* INFO */
.team-info h1{
    font-size:40px;
    font-weight:900;
    margin:0;
}

.team-info span{
    display:inline-block;
    margin-top:6px;
    padding:6px 14px;
    border-radius:999px;
    background:rgba(139,92,246,.15);
    color:#c4b5fd;
    font-size:14px;
}

/* DETAILS */
.team-details{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:18px;
    margin-top:25px;
}

.detail-box{
    background:#020617;
    padding:18px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.08);
}

.detail-box small{
    color:#94a3b8;
    display:block;
    margin-bottom:6px;
}

.detail-box strong{
    font-size:16px;
}

/* ===== PLAYERS ===== */
.players-section{
    margin-top:40px;
}

.players-section h2{
    font-size:26px;
    font-weight:800;
    margin-bottom:20px;
}

/* ROSTER GRID */
.player-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(230px,1fr));
    gap:20px;
}

/* PLAYER CARD */
.player-card{
    background:#020617;
    border:1px solid rgba(255,255,255,.07);
    border-radius:16px;
    padding:20px;
    text-align:center;
    transition:.25s;
}

.player-card:hover{
    transform:translateY(-6px);
    box-shadow:0 20px 40px rgba(0,0,0,.7);
}

/* AVATAR */
.player-avatar{
    width:70px;
    height:70px;
    border-radius:50%;
    background:#111827;
    display:flex;
    align-items:center;
    justify-content:center;
    margin:auto;
    font-weight:800;
    font-size:20px;
    color:#8b5cf6;
    margin-bottom:12px;
}

.player-name{
    font-weight:700;
    margin-bottom:6px;
}

.player-email{
    font-size:13px;
    color:#94a3b8;
}

/* BADGES */
.badge{
    display:inline-block;
    margin-top:8px;
    padding:5px 12px;
    border-radius:999px;
    font-size:12px;
    font-weight:600;
}

/* level colors */
.level-beginner{background:#1e40af;color:white;}
.level-intermediate{background:#065f46;color:white;}
.level-advanced{background:#7c2d12;color:white;}

/* status */
.status-active{background:#14532d;color:white;}
.status-inactive{background:#7f1d1d;color:white;}

/* ACTIONS */
.actions{
    display:flex;
    justify-content:center;
    gap:20px;
    margin-top:40px;
}

.btn-edit{
    padding:14px 30px;
    border-radius:14px;
    background:linear-gradient(135deg,#ec4899,#8b5cf6);
    color:white;
    text-decoration:none;
    font-weight:700;
}

</style>


<div class="page-wrapper">

<div class="team-hero">

    <!-- HEADER -->
    <div class="team-header">

        <div class="team-logo">
            {% if equipe.logo %}
                <img src="{{ asset('uploads/equipes/' ~ equipe.logo) }}">
            {% else %}
                {{ equipe.nom|slice(0,2)|upper }}
            {% endif %}
        </div>

        <div class="team-info">
            <h1>{{ equipe.nom }}</h1>
            <span>{{ equipe.game }} • {{ equipe.categorie }}</span>
        </div>

    </div>

    <!-- DETAILS -->
    <div class="team-details">
        <div class="detail-box">
            <small>Coach</small>
            <strong>{{ equipe.coach.email }}</strong>
        </div>

        <div class="detail-box">
            <small>Game</small>
            <strong>{{ equipe.game }}</strong>
        </div>

        <div class="detail-box">
            <small>Catégorie</small>
            <strong>{{ equipe.categorie }}</strong>
        </div>
    </div>

</div>

<!-- QR CODE JOUEURS -->
<div style="text-align:center; margin-top:40px;">

    <h2 style="margin-bottom:15px;">
         Scanner pour voir les joueurs
    </h2>

    <img 
        src="data:image/png;base64,{{ qrCode }}"
        style="
            width:260px;
            background:white;
            padding:14px;
            border-radius:16px;
            box-shadow:0 20px 40px rgba(0,0,0,.6);
        "
    >

    <p style="margin-top:12px; color:#94a3b8;">
        Le téléphone affichera automatiquement la liste complète
    </p>

</div>

<!-- PLAYERS -->
<div class="players-section">

<h2>Joueurs</h2>

{% if equipe.joueur|length > 0 %}
<div class="player-grid">

{% for joueur in equipe.joueur %}

<div class="player-card">

    <div class="player-avatar">
        {{ joueur.email|slice(0,2)|upper }}
    </div>

    <div class="player-name">{{ joueur.email }}</div>

    <div class="player-email">{{ joueur.pays }}</div>

    <!-- LEVEL -->
    <div class="badge
        {% if joueur.niveau.value == 'BEGINNER' %}level-beginner
        {% elseif joueur.niveau.value == 'INTERMEDIATE' %}level-intermediate
        {% else %}level-advanced{% endif %}">
        {{ joueur.niveau.value|title }}
    </div>

    <!-- STATUS -->
    <div class="badge {{ joueur.statut ? 'status-active' : 'status-inactive' }}">
        {{ joueur.statut ? 'Actif' : 'Inactif' }}
    </div>

</div>

{% endfor %}

</div>

{% else %}
<p style="color:#9ca3af;">Aucun joueur dans cette équipe.</p>
{% endif %}

</div>
  <a  href="{{ path('app_stats_equipeclient', {'id': equipe.id}) }}" class="btn mt-2 btn-edit">
           Voir equipe stats 
        </a>

{% if is_granted('ROLE_ADMIN') %}
<div class="actions">
    <a href="{{ path('app_equipe_edit', {'id': equipe.id}) }}" class="btn-edit">
        ✏ Edit Team
    </a>
    {{ include('equipe/_delete_form.html.twig') }}
</div>
{% endif %}

</div>

{% endblock %}
