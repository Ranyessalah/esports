{% extends 'base.html.twig' %}

{% block title %}Mon Profil | ClutchX{% endblock %}

{% block body %}
<style>
    .profile-section {
        min-height: 100vh;
        padding: 120px 0 80px;
        background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 50%, #0a0a1a 100%);
        position: relative;
    }
    .profile-section::before {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(ellipse at 30% 20%, rgba(139,92,246,0.08) 0%, transparent 60%),
                    radial-gradient(ellipse at 70% 80%, rgba(168,85,247,0.06) 0%, transparent 60%);
        pointer-events: none;
    }
    .profile-container {
        max-width: 620px;
        margin: 0 auto;
        padding: 0 20px;
        position: relative;
        z-index: 1;
    }
    .profile-header {
        text-align: center;
        margin-bottom: 36px;
    }
    .profile-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: linear-gradient(135deg, #7c3aed, #a855f7);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 18px;
        box-shadow: 0 0 30px rgba(139,92,246,0.3);
    }
    .profile-avatar i {
        font-size: 32px;
        color: #fff;
    }
    .profile-header h2 {
        font-family: 'Inter', sans-serif;
        font-size: 26px;
        font-weight: 700;
        color: #fff;
        margin: 0 0 6px;
        letter-spacing: -0.5px;
    }
    .profile-header p {
        font-size: 14px;
        color: rgba(255,255,255,0.5);
        margin: 0;
        font-family: 'Inter', sans-serif;
    }
    .profile-card {
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 36px 32px;
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
    }
    .profile-card .form-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
        margin-bottom: 22px;
    }
    .profile-card .form-group label,
    .profile-card .form-group > label {
        font-family: 'Inter', sans-serif;
        font-size: 13px;
        font-weight: 600;
        color: rgba(255,255,255,0.7);
        text-transform: uppercase;
        letter-spacing: 0.04em;
    }
    .profile-card .form-group input,
    .profile-card .form-group select {
        padding: 12px 16px;
        border: 1.5px solid rgba(255,255,255,0.1);
        border-radius: 10px;
        font-size: 15px;
        color: #fff;
        background: rgba(255,255,255,0.05);
        transition: all 0.25s ease;
        font-family: 'Inter', sans-serif;
        font-weight: 400;
        outline: none;
        width: 100%;
    }
    .profile-card .form-group input:focus,
    .profile-card .form-group select:focus {
        border-color: rgba(139,92,246,0.6);
        box-shadow: 0 0 0 3px rgba(139,92,246,0.12);
        background: rgba(255,255,255,0.07);
    }
    .profile-card .form-group input::placeholder {
        color: rgba(255,255,255,0.3);
    }
    .profile-card .form-group select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23a78bfa' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 14px center;
        padding-right: 40px;
    }
    .profile-card .form-group select option {
        background: #1a0a2e;
        color: #fff;
    }
    .profile-card .form-help {
        font-size: 12px;
        color: rgba(255,255,255,0.35);
        margin-top: 4px;
        font-family: 'Inter', sans-serif;
    }
    .profile-card .checkbox-group {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 22px;
    }
    .profile-card .checkbox-group input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: #7c3aed;
        cursor: pointer;
    }
    .profile-card .checkbox-group label {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        font-weight: 500;
        color: rgba(255,255,255,0.7);
        cursor: pointer;
        margin: 0;
    }
    .profile-card .radio-group {
        display: flex;
        gap: 20px;
        align-items: center;
    }
    .profile-card .radio-group label {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        font-weight: 500;
        color: rgba(255,255,255,0.7);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        text-transform: none;
        letter-spacing: 0;
    }
    .profile-card .radio-group input[type="radio"] {
        accent-color: #7c3aed;
        width: 17px;
        height: 17px;
    }
    .profile-divider {
        border: none;
        border-top: 1px solid rgba(255,255,255,0.08);
        margin: 28px 0 24px;
    }
    .profile-actions {
        display: flex;
        gap: 12px;
        margin-top: 28px;
    }
    .btn-profile-save {
        flex: 1;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 13px 24px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-family: 'Inter', sans-serif;
        font-size: 15px;
        font-weight: 600;
        color: #fff;
        background: linear-gradient(135deg, #7c3aed, #a855f7);
        box-shadow: 0 4px 15px rgba(139,92,246,0.3);
        transition: all 0.25s ease;
        letter-spacing: -0.2px;
    }
    .btn-profile-save:hover {
        box-shadow: 0 6px 25px rgba(139,92,246,0.45);
        transform: translateY(-1px);
    }
    .btn-profile-save:active { transform: translateY(0); }
    .btn-profile-back {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 13px 24px;
        border: 1.5px solid rgba(255,255,255,0.12);
        border-radius: 10px;
        cursor: pointer;
        font-family: 'Inter', sans-serif;
        font-size: 15px;
        font-weight: 500;
        color: rgba(255,255,255,0.6);
        background: transparent;
        transition: all 0.25s ease;
        text-decoration: none;
    }
    .btn-profile-back:hover {
        border-color: rgba(255,255,255,0.25);
        color: rgba(255,255,255,0.85);
        background: rgba(255,255,255,0.04);
    }
    .flash-profile-success {
        display: flex;
        align-items: center;
        gap: 10px;
        background: rgba(34,197,94,0.1);
        border: 1px solid rgba(34,197,94,0.2);
        color: #86efac;
        padding: 14px 18px;
        border-radius: 10px;
        margin-bottom: 24px;
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        font-weight: 500;
    }
    .flash-profile-success i {
        font-size: 18px;
        color: #22c55e;
    }
    .profile-card .form-group ul,
    .profile-card .checkbox-group ul,
    .profile-card .radio-group ul {
        list-style: none;
        padding: 0;
        margin: 6px 0 0;
    }
    .profile-card .form-group ul li,
    .profile-card .checkbox-group ul li,
    .profile-card .radio-group ul li,
    .profile-card .form-error-message {
        color: #fca5a5;
        font-size: 12px;
        font-weight: 500;
        background: rgba(239,68,68,0.1);
        border: 1px solid rgba(239,68,68,0.2);
        padding: 7px 12px;
        border-radius: 6px;
        margin-top: 4px;
        font-family: 'Inter', sans-serif;
    }
    @media (max-width: 640px) {
        .profile-section { padding: 100px 0 60px; }
        .profile-card { padding: 28px 20px; }
        .profile-header h2 { font-size: 22px; }
        .profile-actions { flex-direction: column; }
        .btn-profile-save, .btn-profile-back { width: 100%; }
    }
</style>

<section class="profile-section">
    <div class="profile-container">
        <div class="profile-header">
            <div class="profile-avatar">
                <i class="fa fa-user"></i>
            </div>
            <h2>Mon Profil</h2>
            <p>Mettre à jour mes informations personnelles</p>
        </div>

        {% for message in app.flashes('profile_success') %}
            <div class="flash-profile-success">
                <i class="fa fa-check-circle"></i>
                {{ message }}
            </div>
        {% endfor %}

        <div class="profile-card">
            {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}

                {# ── Email ── #}
                <div class="form-group">
                    {{ form_label(form.email, 'Email') }}
                    {{ form_widget(form.email, {'attr': {'placeholder': 'exemple@domaine.com'}}) }}
                    {{ form_errors(form.email) }}
                    <small class="form-help">L'adresse email sera utilisée pour la connexion</small>
                </div>

                {# ── Mot de passe ── #}
                <div class="form-group">
                    {{ form_label(form.plainPassword.first, 'Nouveau mot de passe') }}
                    {{ form_widget(form.plainPassword.first, {'attr': {'placeholder': 'Laisser vide pour ne pas modifier'}}) }}
                    {{ form_errors(form.plainPassword.first) }}
                    <small class="form-help">Minimum 8 caractères, 1 majuscule, 1 caractère spécial</small>
                </div>

                {# ── Confirmer mot de passe ── #}
                <div class="form-group">
                    {{ form_label(form.plainPassword.second, 'Confirmer le mot de passe') }}
                    {{ form_widget(form.plainPassword.second, {'attr': {'placeholder': 'Confirmer le mot de passe'}}) }}
                    {{ form_errors(form.plainPassword.second) }}
                </div>

                {{ form_errors(form.plainPassword) }}

                <hr class="profile-divider">

                {# ── Pays ── #}
                <div class="form-group">
                    {{ form_label(form.pays, 'Pays') }}
                    {{ form_widget(form.pays) }}
                    {{ form_errors(form.pays) }}
                </div>

                {# ── Player-specific fields ── #}
                {% if is_granted('ROLE_PLAYER') %}
                    <div class="form-group">
                        {{ form_label(form.niveau, 'Niveau') }}
                        {{ form_widget(form.niveau) }}
                        {{ form_errors(form.niveau) }}
                    </div>

                    <div class="checkbox-group">
                        {{ form_widget(form.statut) }}
                        {{ form_label(form.statut, 'Compte actif') }}
                    </div>
                {% endif %}

                {# ── Coach-specific fields ── #}
                {% if is_granted('ROLE_COACH') %}
                    <div class="form-group">
                        {{ form_label(form.specialite, 'Spécialité') }}
                        {{ form_widget(form.specialite) }}
                        {{ form_errors(form.specialite) }}
                    </div>

                    <div class="form-group">
                        {{ form_label(form.disponibilite, 'Disponibilité') }}
                        <div class="radio-group">
                            {{ form_widget(form.disponibilite) }}
                        </div>
                        {{ form_errors(form.disponibilite) }}
                    </div>
                {% endif %}

                {# ── Actions ── #}
                <div class="profile-actions">
                    <button type="submit" class="btn-profile-save">
                        <i class="fa fa-check"></i>
                        Enregistrer
                    </button>
                    <a href="{{ path('app_home') }}" class="btn-profile-back">
                        <i class="fa fa-arrow-left"></i>
                        Retour
                    </a>
                </div>

            {{ form_end(form) }}
        </div>
    </div>
</section>
{% endblock %}
